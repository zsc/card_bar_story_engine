game_id: mist_harbor
title: "雾港回声"
version: "1.2.0"
language: "zh-CN"
tone: "noir_mystery"
content_rating: "PG-13"

llm:
  recommended_model: "gpt-4.1-mini-or-gemini-1.5"
  temperature: 0.8
  max_output_tokens: 900

status_bar:
  items:
    - var_id: hp
      label: "生命"
      style: meter
      show_delta: true
      critical_threshold: 25
    - var_id: energy
      label: "精力"
      style: meter
      show_delta: true
      critical_threshold: 20
    - var_id: suspicion
      label: "嫌疑"
      style: meter
      show_delta: true
      critical_threshold: 80
    - var_id: pressure
      label: "压力"
      style: meter
      show_delta: true
      critical_threshold: 80
    - var_id: clues
      label: "线索"
      style: text
      show_delta: true
      critical_threshold: 0
    - var_id: gold
      label: "币"
      style: text
      show_delta: true
      critical_threshold: 0
    - var_id: time
      label: "时间"
      style: text
      show_delta: false

variables:
  - id: hp
    label: "生命"
    type: integer
    min: 0
    max: 100
    default: 80
    card: { visible: false, order: 0, format: plain, description: "你还能撑多久。", prompt_weight: high }
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["resource"]

  - id: energy
    label: "精力"
    type: integer
    min: 0
    max: 100
    default: 70
    card: { visible: false, order: 0, format: plain, description: "行动效率与判断力的底盘。", prompt_weight: high }
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["resource"]

  - id: gold
    label: "硬币"
    type: integer
    min: 0
    max: 999
    default: 12
    card: { visible: false, order: 0, format: plain, description: "买消息、坐车、塞封口费。", prompt_weight: medium }
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["resource"]

  - id: time
    label: "时间"
    type: object
    default:
      day: 1
      hour: 20
      minute: 10
    card:
      visible: true
      order: 10
      format: keyvalue
      description: "雾港的夜会把所有人吞掉。午夜前必须做出结论。"
      prompt_weight: high
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["resource"]

  - id: suspicion
    label: "嫌疑"
    type: integer
    min: 0
    max: 100
    default: 10
    card:
      visible: true
      order: 20
      format: bar
      description: "你被盯上的程度。越高越危险。"
      prompt_weight: high
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["risk"]

  - id: pressure
    label: "压力"
    type: integer
    min: 0
    max: 100
    default: 20
    card:
      visible: true
      order: 25
      format: bar
      description: "城市与时间对你施压的总量。"
      prompt_weight: high
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["risk"]

  - id: clues
    label: "线索"
    type: integer
    min: 0
    max: 12
    default: 0
    card:
      visible: true
      order: 30
      format: bar
      description: "你已拼到的关键拼图数量。"
      prompt_weight: high
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["progress"]

  - id: truth_map
    label: "真相拼图"
    type: list
    default: []
    card:
      visible: true
      order: 40
      format: list
      description: "用一句话记录确认过的事实。"
      prompt_weight: medium
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["knowledge"]

  - id: leads
    label: "待追线索"
    type: list
    default: []
    card:
      visible: true
      order: 45
      format: list
      description: "还没跟进的线索与行动方向。"
      prompt_weight: medium
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["progress"]

  - id: location
    label: "所在地点"
    type: enum
    enum_values: ["码头", "灯塔", "旧电厂", "钟楼街", "鸦巢酒吧", "报社", "医院", "档案馆"]
    default: "鸦巢酒吧"
    card:
      visible: true
      order: 50
      format: plain
      description: "你当前所处的位置。"
      prompt_weight: high
    rules: { clamp: false, readonly: false, update_policy: set_only }
    tags: ["world"]

  - id: relationships
    label: "关系"
    type: object
    default:
      lian: 35
      mayor: -10
      dockmaster: 5
      editor: 10
      chief: 0
    card:
      visible: true
      order: 60
      format: keyvalue
      description: "人脉会决定你拿到真相还是被沉海。范围 -100..100。"
      prompt_weight: medium
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["relationship"]

  - id: reputation
    label: "声望"
    type: integer
    min: -100
    max: 100
    default: 0
    card:
      visible: true
      order: 65
      format: plain
      description: "街面与体面两边对你的评价。"
      prompt_weight: low
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["relationship"]

  - id: threads
    label: "调查线"
    type: object
    default:
      blackout: 0
      city_hall: 0
      union: 0
      smuggling: 0
    card:
      visible: true
      order: 67
      format: keyvalue
      description: "每条线索线的推进程度（0-3）。"
      prompt_weight: medium
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["progress"]

  - id: inventory
    label: "随身物品"
    type: list
    default: ["旧怀表", "纸烟", "折叠小刀", "防水火柴", "旧名片"]
    card:
      visible: true
      order: 70
      format: list
      description: "能用就用，别逞强。"
      prompt_weight: low
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["items"]

  - id: debts
    label: "人情债"
    type: integer
    min: 0
    max: 5
    default: 1
    card:
      visible: true
      order: 75
      format: plain
      description: "你欠别人或别人欠你的账。"
      prompt_weight: low
    rules: { clamp: true, readonly: false, update_policy: any }
    tags: ["resource"]

  - id: flags
    label: "旗标"
    type: object
    default:
      met_lian: false
      power_sabotage_confirmed: false
      chased: false
      energy_low_warn: false
      night_deep: false
      archive_opened: false
      mayor_contacted: false
      plant_infiltrated: false
      leak_ready: false
      broke_warn: false
      breaking_point: false
      dock_checked: false
      lighthouse_checked: false
      hospital_checked: false
      press_checked: false
      bar_briefed: false
      late_warn: false
      union_break: false
      smuggling_break: false
    card:
      visible: true
      order: 80
      format: keyvalue
      description: "引擎内部的剧情开关。"
      prompt_weight: low
    rules: { clamp: false, readonly: false, update_policy: any }
    tags: ["flag"]

initial_state:
  hp: 80
  energy: 70
  gold: 12
  time: { day: 1, hour: 20, minute: 10 }
  suspicion: 10
  pressure: 20
  clues: 0
  truth_map: []
  leads:
    - "确认停电前后进出旧电厂的人"
    - "找出谁在买消息"
    - "查清灯塔值班日志缺失的原因"
    - "核对备电清单缺失的一页"
  location: "鸦巢酒吧"
  relationships: { lian: 35, mayor: -10, dockmaster: 5, editor: 10, chief: 0 }
  reputation: 0
  threads: { blackout: 0, city_hall: 0, union: 0, smuggling: 0 }
  inventory: ["旧怀表", "纸烟", "折叠小刀", "防水火柴", "旧名片"]
  debts: 1
  flags:
    met_lian: false
    power_sabotage_confirmed: false
    chased: false
    energy_low_warn: false
    night_deep: false
    archive_opened: false
    mayor_contacted: false
    plant_infiltrated: false
    leak_ready: false
    broke_warn: false
    breaking_point: false
    dock_checked: false
    lighthouse_checked: false
    hospital_checked: false
    press_checked: false
    bar_briefed: false
    late_warn: false
    union_break: false
    smuggling_break: false

win_conditions:
  - "flags.power_sabotage_confirmed == true and clues >= 8"
  - "flags.leak_ready == true and clues >= 6"
lose_conditions:
  - "hp <= 0"
  - "suspicion >= 100"
  - "pressure >= 100"
  - "time.hour >= 24"

prompt_rules:
  style_notes:
    - "新黑色：潮湿、霓虹、雾、短句、暗喻克制。"
    - "调查推进：每回合推进一个线索/关系/风险。"
    - "关键地点有限：码头 / 灯塔 / 旧电厂 / 钟楼街 / 鸦巢酒吧 / 报社 / 医院 / 档案馆。"
    - "关键人物有限：黎安、码头总管、市长顾问、报社编辑、警署长官。"
    - "优先使用待追线索（leads）与调查线（threads）驱动行动。"
  boundaries:
    - "PG-13：不写露骨性内容，不描写血腥细节。"
    - "不输出真实世界违法操作指南。"
    - "不能替玩家做决定，必须给出选择。"
